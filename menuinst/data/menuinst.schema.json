{
  "title": "MenuInstSchema",
  "description": "Metadata required to create menu items across operating systems with `menuinst`",
  "type": "object",
  "properties": {
    "menu_name": {
      "title": "Menu Name",
      "description": "Name for the category containing the items specified in `menu_items`.",
      "minLength": 1,
      "type": "string"
    },
    "menu_items": {
      "title": "Menu Items",
      "description": "List of menu entries to create across main desktop systems",
      "minItems": 1,
      "type": "array",
      "items": {
        "$ref": "#/definitions/MenuItem"
      }
    },
    "$id": {
      "title": "$Id",
      "description": "Version of the menuinst schema",
      "enum": [
        "https://schemas.conda.io/menuinst-1.schema.json"
      ],
      "type": "string"
    },
    "$schema": {
      "title": "$Schema",
      "description": "Standard of the JSON schema we adhere to",
      "enum": [
        "https://json-schema.org/draft-07/schema"
      ],
      "type": "string"
    }
  },
  "required": [
    "menu_name",
    "menu_items",
    "$id",
    "$schema"
  ],
  "additionalProperties": false,
  "definitions": {
    "Windows": {
      "title": "Windows",
      "description": "Windows-specific instructions. You can override global keys here if needed",
      "type": "object",
      "properties": {
        "name": {
          "title": "Name",
          "description": "The name of the menu item",
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "title": "Description",
          "description": "A longer description of the menu item. Shown on popup messages.",
          "type": "string"
        },
        "icon": {
          "title": "Icon",
          "description": "Path to the file representing or containing the icon.",
          "minLength": 1,
          "type": "string"
        },
        "precommand": {
          "title": "Precommand",
          "description": "(Simple, preferrably single-line) logic to run before the command is run. Runs before the env is activated, if that applies.",
          "minLength": 1,
          "type": "string"
        },
        "precreate": {
          "title": "Precreate",
          "description": "(Simple, preferrably single-line) logic to run before the shortcut is created.",
          "minLength": 1,
          "type": "string"
        },
        "command": {
          "title": "Command",
          "description": "Command to run with the menu item, expressed as a list of strings where each string is an argument",
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "working_dir": {
          "title": "Working Dir",
          "description": "Working directory for the running process. Defaults to user directory on each platform.",
          "minLength": 1,
          "type": "string"
        },
        "activate": {
          "title": "Activate",
          "description": "Whether to activate the target environment before running `command`.",
          "type": "boolean"
        },
        "terminal": {
          "title": "Terminal",
          "description": "Whether run the program in a terminal/console or not. On Windows, it only has an effect if activate is true. On MacOS, arguments are ignored.",
          "type": "boolean"
        },
        "desktop": {
          "title": "Desktop",
          "description": "Whether to create a desktop icon in addition to the Start Menu item.",
          "default": true,
          "type": "boolean"
        },
        "quicklaunch": {
          "title": "Quicklaunch",
          "description": "Whether to create a quick launch icon in addition to the Start Menu item.",
          "default": true,
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "Linux": {
      "title": "Linux",
      "description": "Linux-specific instructions. Check\nhttps://specifications.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html#recognized-keys\nfor more information. You can override global keys here if needed",
      "type": "object",
      "properties": {
        "name": {
          "title": "Name",
          "description": "The name of the menu item",
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "title": "Description",
          "description": "A longer description of the menu item. Shown on popup messages.",
          "type": "string"
        },
        "icon": {
          "title": "Icon",
          "description": "Path to the file representing or containing the icon.",
          "minLength": 1,
          "type": "string"
        },
        "precommand": {
          "title": "Precommand",
          "description": "(Simple, preferrably single-line) logic to run before the command is run. Runs before the env is activated, if that applies.",
          "minLength": 1,
          "type": "string"
        },
        "precreate": {
          "title": "Precreate",
          "description": "(Simple, preferrably single-line) logic to run before the shortcut is created.",
          "minLength": 1,
          "type": "string"
        },
        "command": {
          "title": "Command",
          "description": "Command to run with the menu item, expressed as a list of strings where each string is an argument",
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "working_dir": {
          "title": "Working Dir",
          "description": "Working directory for the running process. Defaults to user directory on each platform.",
          "minLength": 1,
          "type": "string"
        },
        "activate": {
          "title": "Activate",
          "description": "Whether to activate the target environment before running `command`.",
          "type": "boolean"
        },
        "terminal": {
          "title": "Terminal",
          "description": "Whether run the program in a terminal/console or not. On Windows, it only has an effect if activate is true. On MacOS, arguments are ignored.",
          "type": "boolean"
        },
        "Categories": {
          "title": "Categories",
          "description": "Categories in which the entry should be shown in a menu. See 'Registered categories' in http://www.freedesktop.org/Standards/menu-spec.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "DBusActivatable": {
          "title": "Dbusactivatable",
          "description": "A boolean value specifying if D-Bus activation is supported for this application.",
          "type": "boolean"
        },
        "GenericName": {
          "title": "Genericname",
          "description": "Generic name of the application; e.g. if the name is 'conda', this would be 'Package Manager'.",
          "type": "string"
        },
        "Hidden": {
          "title": "Hidden",
          "description": "Disable shortcut, signaling a missing resource.",
          "type": "boolean"
        },
        "Implements": {
          "title": "Implements",
          "description": "List of supported interfaces. See https://specifications.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html#interfaces",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "Keywords": {
          "title": "Keywords",
          "description": "Additional terms to describe this shortcut to aid in searching.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "MimeType": {
          "title": "Mimetype",
          "description": "The MIME type(s) supported by this application.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "NoDisplay": {
          "title": "Nodisplay",
          "description": "Do not show this item in the menu. Useful to associate MIME types and other registrations, without having an actual clickable item. Not to be confused with 'Hidden'.",
          "type": "boolean"
        },
        "NotShowIn": {
          "title": "Notshowin",
          "description": "Desktop environments that should NOT display this item. It'll check against $XDG_CURRENT_DESKTOP.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "OnlyShowIn": {
          "title": "Onlyshowin",
          "description": "Desktop environments that should display this item. It'll check against $XDG_CURRENT_DESKTOP.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string",
              "pattern": "^.+;$"
            }
          ]
        },
        "PrefersNonDefaultGPU": {
          "title": "Prefersnondefaultgpu",
          "description": "Hint that the app prefers to be run on a more powerful discrete GPU if available",
          "type": "boolean"
        },
        "StartupNotify": {
          "title": "Startupnotify",
          "description": "Advanced. See https://www.freedesktop.org/wiki/Specifications/startup-notification-spec/",
          "type": "boolean"
        },
        "StartupWMClass": {
          "title": "Startupwmclass",
          "description": "Advanced. See https://www.freedesktop.org/wiki/Specifications/startup-notification-spec/",
          "type": "string"
        },
        "TryExec": {
          "title": "Tryexec",
          "description": "Filename or absolute path to an executable file on disk used to determine if the program is actually installed and can be run. If the test fails, the shortcut might be ignored / hidden.",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "_CFBundleURLTypes": {
      "title": "_CFBundleURLTypes",
      "description": "Describes a URL scheme associated with the app.",
      "type": "object",
      "properties": {
        "CFBundleTypeRole": {
          "title": "Cfbundletyperole",
          "description": "This key specifies the app's role with respect to the URL.",
          "enum": [
            "Editor",
            "Viewer",
            "Shell",
            "None"
          ],
          "type": "string"
        },
        "CFBundleURLSchemes": {
          "title": "Cfbundleurlschemes",
          "description": "URL schemes / protocols handled by this type (e.g. 'mailto').",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "CFBundleURLName": {
          "title": "Cfbundleurlname",
          "description": "Abstract name for this URL type. Uniqueness recommended.",
          "type": "string"
        },
        "CFBundleURLIconFile": {
          "title": "Cfbundleurliconfile",
          "description": "Name of the icon image file (minus the .icns extension).",
          "type": "string"
        }
      },
      "required": [
        "CFBundleTypeRole",
        "CFBundleURLSchemes"
      ],
      "additionalProperties": false
    },
    "_CFBundleDocumentTypes": {
      "title": "_CFBundleDocumentTypes",
      "description": "Describes a document type associated with the app.",
      "type": "object",
      "properties": {
        "CFBundleTypeIconFile": {
          "title": "Cfbundletypeiconfile",
          "description": "Name of the icon image file (minus the .icns extension).",
          "type": "string"
        },
        "CFBundleTypeName": {
          "title": "Cfbundletypename",
          "description": "Abstract name for this document type. Uniqueness recommended.",
          "type": "string"
        },
        "CFBundleTypeRole": {
          "title": "Cfbundletyperole",
          "description": "This key specifies the app's role with respect to the type.",
          "enum": [
            "Editor",
            "Viewer",
            "Shell",
            "None"
          ],
          "type": "string"
        },
        "LSItemContentTypes": {
          "title": "Lsitemcontenttypes",
          "description": "List of UTI strings defining a supported file type; e.g. for PNG files, use 'public.png'. Sync with 'NSExportableTypes' key with the appropriate entries",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "LSHandlerRank": {
          "title": "Lshandlerrank",
          "description": "Determines how Launch Services ranks this app among the apps that declare themselves editors or viewers of files of this type.",
          "enum": [
            "Owner",
            "Default",
            "Alternate"
          ],
          "type": "string"
        }
      },
      "required": [
        "CFBundleTypeName",
        "CFBundleTypeRole",
        "LSItemContentTypes",
        "LSHandlerRank"
      ],
      "additionalProperties": false
    },
    "MacOS": {
      "title": "MacOS",
      "description": "Mac-specific instructions. Check these URLs for more info:\n- CF* keys: https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html\n- LS* keys: https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html\n- entitlements: list those which should be true for the shortcut signing\n  See https://developer.apple.com/documentation/bundleresources/entitlements.\n\nYou can also override global keys here if needed.",
      "type": "object",
      "properties": {
        "name": {
          "title": "Name",
          "description": "The name of the menu item",
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "title": "Description",
          "description": "A longer description of the menu item. Shown on popup messages.",
          "type": "string"
        },
        "icon": {
          "title": "Icon",
          "description": "Path to the file representing or containing the icon.",
          "minLength": 1,
          "type": "string"
        },
        "precommand": {
          "title": "Precommand",
          "description": "(Simple, preferrably single-line) logic to run before the command is run. Runs before the env is activated, if that applies.",
          "minLength": 1,
          "type": "string"
        },
        "precreate": {
          "title": "Precreate",
          "description": "(Simple, preferrably single-line) logic to run before the shortcut is created.",
          "minLength": 1,
          "type": "string"
        },
        "command": {
          "title": "Command",
          "description": "Command to run with the menu item, expressed as a list of strings where each string is an argument",
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "working_dir": {
          "title": "Working Dir",
          "description": "Working directory for the running process. Defaults to user directory on each platform.",
          "minLength": 1,
          "type": "string"
        },
        "activate": {
          "title": "Activate",
          "description": "Whether to activate the target environment before running `command`.",
          "type": "boolean"
        },
        "terminal": {
          "title": "Terminal",
          "description": "Whether run the program in a terminal/console or not. On Windows, it only has an effect if activate is true. On MacOS, arguments are ignored.",
          "type": "boolean"
        },
        "CFBundleDisplayName": {
          "title": "Cfbundledisplayname",
          "description": "Display name of the bundle, visible to users and used by Siri. If not provided, 'menuinst' will use the 'name' field.",
          "type": "string"
        },
        "CFBundleIdentifier": {
          "title": "Cfbundleidentifier",
          "type": "string"
        },
        "CFBundleName": {
          "title": "Cfbundlename",
          "description": "Short name of the bundle. Maybe used if 'CFBundleDisplayName' is absent. If not provided, 'menuinst' will generate one from the 'name' field.",
          "maxLength": 16,
          "type": "string"
        },
        "CFBundleSpokenName": {
          "title": "Cfbundlespokenname",
          "description": "Suitable replacement for text-to-speech operations on the app For example, 'my app one two three' instead of 'MyApp123'.",
          "type": "string"
        },
        "CFBundleVersion": {
          "title": "Cfbundleversion",
          "description": "Build version number for the bundle. In the context of 'menuinst' this can be used to signal a new version of the menu item for the same application version.",
          "pattern": "^\\S+$",
          "type": "string"
        },
        "CFBundleURLTypes": {
          "title": "Cfbundleurltypes",
          "description": "URL types supported by this app.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/_CFBundleURLTypes"
          }
        },
        "CFBundleDocumentTypes": {
          "title": "Cfbundledocumenttypes",
          "description": "Document types supported by this app.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/_CFBundleDocumentTypes"
          }
        },
        "LSApplicationCategoryType": {
          "title": "Lsapplicationcategorytype",
          "description": "The App Store uses this string to determine the appropriate categorization for the app",
          "pattern": "^public\\.app-category\\.\\S+$",
          "type": "string"
        },
        "LSBackgroundOnly": {
          "title": "Lsbackgroundonly",
          "description": "Specifies whether this app runs only in the background.",
          "type": "boolean"
        },
        "LSEnvironment": {
          "title": "Lsenvironment",
          "description": "List of key-value pairs used to define environment variables.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "LSMinimumSystemVersion": {
          "title": "Lsminimumsystemversion",
          "description": "Minimum version of macOS required for this app to run, as x.y.z. For example, for macOS v10.4 and later, use '10.4.0'.",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "type": "string"
        },
        "LSMultipleInstancesProhibited": {
          "title": "Lsmultipleinstancesprohibited",
          "description": "Whether an app is prohibited from running simultaneously in multiple user sessions",
          "type": "boolean"
        },
        "LSRequiresNativeExecution": {
          "title": "Lsrequiresnativeexecution",
          "description": "If true, prevent a universal binary from being run under Rosetta emulation on an Intel-based Mac",
          "type": "boolean"
        },
        "entitlements": {
          "title": "Entitlements",
          "description": "List of permissions to request for the launched application. See https://developer.apple.com/documentation/bundleresources/entitlements for a full list of possible values.",
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "[a-z0-9\\.\\-]+"
          }
        },
        "link_in_bundle": {
          "title": "Link In Bundle",
          "description": "Paths that should be symlinked into the shortcut app bundle. It takes a mapping of source to destination paths. Destination paths must be relative. Placeholder `{{ MENU_ITEM_LOCATION }}` can be useful.",
          "type": "object",
          "additionalProperties": {
            "type": "string",
            "pattern": "^(?!\\/)(?!\\.\\./).*"
          }
        }
      },
      "additionalProperties": false
    },
    "Platforms": {
      "title": "Platforms",
      "description": "Platform specific options. Presence of a platform enables menu items in that platform",
      "type": "object",
      "properties": {
        "win": {
          "$ref": "#/definitions/Windows"
        },
        "linux": {
          "$ref": "#/definitions/Linux"
        },
        "osx": {
          "$ref": "#/definitions/MacOS"
        }
      },
      "additionalProperties": false
    },
    "MenuItem": {
      "title": "MenuItem",
      "description": "Instructions to create a menu item across operating systems.",
      "type": "object",
      "properties": {
        "name": {
          "title": "Name",
          "description": "The name of the menu item",
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "title": "Description",
          "description": "A longer description of the menu item. Shown on popup messages.",
          "type": "string"
        },
        "icon": {
          "title": "Icon",
          "description": "Path to the file representing or containing the icon.",
          "minLength": 1,
          "type": "string"
        },
        "precommand": {
          "title": "Precommand",
          "description": "(Simple, preferrably single-line) logic to run before the command is run. Runs before the env is activated, if that applies.",
          "minLength": 1,
          "type": "string"
        },
        "precreate": {
          "title": "Precreate",
          "description": "(Simple, preferrably single-line) logic to run before the shortcut is created.",
          "minLength": 1,
          "type": "string"
        },
        "command": {
          "title": "Command",
          "description": "Command to run with the menu item, expressed as a list of strings where each string is an argument",
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "working_dir": {
          "title": "Working Dir",
          "description": "Working directory for the running process. Defaults to user directory on each platform.",
          "minLength": 1,
          "type": "string"
        },
        "activate": {
          "title": "Activate",
          "description": "Whether to activate the target environment before running `command`.",
          "default": true,
          "type": "boolean"
        },
        "terminal": {
          "title": "Terminal",
          "description": "Whether run the program in a terminal/console or not. On Windows, it only has an effect if activate is true. On MacOS, arguments are ignored.",
          "default": false,
          "type": "boolean"
        },
        "platforms": {
          "$ref": "#/definitions/Platforms"
        }
      },
      "required": [
        "name",
        "description",
        "command",
        "platforms"
      ],
      "additionalProperties": false
    }
  }
}